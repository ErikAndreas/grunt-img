#!/usr/bin/env node
var fs = require('fs'),
  join = require('path').join,
  help = join(__dirname, 'help.txt'),
  cli = require('grunt/lib/grunt/cli');

// register this plugin to grunt npm tasks
var grunt = require('grunt').npmTasks(join(__dirname, '../')),
  opts = cli.options,
  cmds = cli.tasks,
  route = cmds.join(' ').trim('');

// custom help, on `h5bp help`
if(/^help/.test(route)) {
  if(/^help$/.test(route)) return fs.createReadStream(help).pipe(process.stdout);
  cli.tasks = cmds.join(':');
}

if(opts.version) {
  console.log('h5bp  v%s', require('../package.json').version);
}

if(/^init$/.test(route)) {
  cli.tasks = 'init:h5bp';
}

// the grunt cli
cli(opts);
